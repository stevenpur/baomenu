<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小恐龍廚房</title>

    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3d4a3d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="小恐龍廚房">
    <link rel="apple-touch-icon" href="/chef.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Noto+Serif+TC:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Firebase SDK (loaded before our code) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="menu">
        <span class="corner corner-tl">🌿</span>
        <span class="corner corner-tr">🌿</span>
        <span class="corner corner-bl">🌿</span>
        <span class="corner corner-br">🌿</span>

        <!-- Screen 1: Role Selection -->
        <div id="roleScreen" class="screen active">
            <header>
                <div class="ornament">🦕 ✦ 🦖</div>
                <h1>小恐龍廚房</h1>
                <p class="subtitle">歡迎光臨</p>
            </header>

            <div class="divider">
                <span class="divider-line"></span>
                <span class="divider-icon">❀</span>
                <span class="divider-line"></span>
            </div>

            <div class="section-title">— 請選擇身份 —</div>

            <div class="role-buttons">
                <button class="role-btn" onclick="selectRole('customer')">
                    <div class="role-btn-icon">🍽️</div>
                    <div class="role-btn-title">我要點餐</div>
                    <div class="role-btn-desc">Customer - Order food</div>
                </button>

                <button class="role-btn" onclick="selectRole('chef')">
                    <div class="role-btn-icon">👨‍🍳</div>
                    <div class="role-btn-title">我是廚師</div>
                    <div class="role-btn-desc">Chef - View orders</div>
                </button>

                <button class="role-btn" onclick="selectRole('manager')">
                    <div class="role-btn-icon">📝</div>
                    <div class="role-btn-title">管理食譜</div>
                    <div class="role-btn-desc">Manage recipes & ingredients</div>
                </button>
            </div>

            <footer>
                <p class="footer-text">用滿滿的愛為你準備 <span class="footer-dino">🦖</span></p>
            </footer>
        </div>

        <!-- Screen 2: Login -->
        <div id="loginScreen" class="screen">
            <header>
                <div class="ornament">🦕 ✦ 🦖</div>
                <h1>小恐龍廚房</h1>
                <p class="subtitle" id="loginSubtitle">登入</p>
            </header>

            <div class="divider">
                <span class="divider-line"></span>
                <span class="divider-icon">❀</span>
                <span class="divider-line"></span>
            </div>

            <div class="login-section">
                <p style="color: #8fb88f; margin-bottom: 20px;">請先登入以繼續</p>
                <button class="login-btn" onclick="signInWithGoogle()">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                    使用 Google 登入
                </button>
            </div>

            <button class="btn btn-secondary" onclick="goBack()" style="margin-top: 30px;">
                ← 返回
            </button>

            <footer>
                <p class="footer-text">用滿滿的愛為你準備 <span class="footer-dino">🦖</span></p>
            </footer>
        </div>

        <!-- Screen 3: Customer Menu -->
        <div id="customerScreen" class="screen">
            <header>
                <div class="ornament">🦕 ✦ 🦖</div>
                <h1>小恐龍廚房</h1>
                <p class="subtitle">今天想吃什麼呢？</p>
            </header>

            <div class="user-info" id="customerUserInfo"></div>

            <div class="divider">
                <span class="divider-line"></span>
                <span class="divider-icon">❀</span>
                <span class="divider-line"></span>
            </div>

            <div class="section-title">— 今日菜單 —</div>

            <div class="menu-items" id="menuItemsContainer">
                <div class="no-orders">
                    <div class="no-orders-icon">🍳</div>
                    <p>載入菜單中...</p>
                </div>
            </div>

            <div class="notes-section">
                <label>Special Requests · 備註</label>
                <textarea id="notes" rows="2" placeholder="有什麼特別的要求嗎？"></textarea>
            </div>

            <button class="btn" id="orderBtn" disabled>
                請選擇餐點
            </button>

            <!-- Chat Section -->
            <div class="chat-section">
                <div class="section-title">— 留言給廚師 💬 —</div>
                <div class="chat-messages" id="customerChatMessages">
                    <div class="no-messages">還沒有訊息</div>
                </div>
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="customerChatInput" placeholder="輸入訊息...">
                    <button class="chat-send-btn" onclick="sendMessage('customer')">送出</button>
                </div>
            </div>

            <button class="btn btn-secondary" onclick="signOut()">
                登出
            </button>

            <footer>
                <p class="footer-text">用滿滿的愛為你準備 <span class="footer-dino">🦖</span></p>
            </footer>
        </div>

        <!-- Screen 4: Chef Orders -->
        <div id="chefScreen" class="screen">
            <header>
                <div class="ornament">🦕 ✦ 🦖</div>
                <h1>小恐龍廚房</h1>
                <p class="subtitle">訂單管理</p>
            </header>

            <div class="user-info" id="chefUserInfo"></div>

            <div class="divider">
                <span class="divider-line"></span>
                <span class="divider-icon">❀</span>
                <span class="divider-line"></span>
            </div>

            <div class="section-title">— 待處理訂單 —</div>

            <div class="orders-list" id="ordersList">
                <div class="no-orders">
                    <div class="no-orders-icon">🦕</div>
                    <p>目前沒有訂單</p>
                    <p style="font-size: 12px; margin-top: 5px;">等待中...</p>
                </div>
            </div>

            <!-- Ingredient Urgency Section -->
            <div class="chat-section">
                <div class="section-title">— 食材狀態 🥬 —</div>
                <div class="ingredient-list" id="ingredientList">
                    <p class="no-messages">載入中...</p>
                </div>
            </div>

            <!-- Chat Section -->
            <div class="chat-section">
                <div class="section-title">— 留言給顧客 💬 —</div>
                <div class="chat-messages" id="chefChatMessages">
                    <div class="no-messages">還沒有訊息</div>
                </div>
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chefChatInput" placeholder="輸入訊息...">
                    <button class="chat-send-btn" onclick="sendMessage('chef')">送出</button>
                </div>
            </div>

            <button class="btn btn-secondary" onclick="signOut()">
                登出
            </button>

            <footer>
                <p class="footer-text">用滿滿的愛為你準備 <span class="footer-dino">🦖</span></p>
            </footer>
        </div>

        <!-- Screen 5: Recipe Management -->
        <div id="managerScreen" class="screen">
            <header>
                <div class="ornament">🦕 ✦ 🦖</div>
                <h1>小恐龍廚房</h1>
                <p class="subtitle">食譜管理</p>
            </header>

            <div class="user-info" id="managerUserInfo"></div>

            <div class="divider">
                <span class="divider-line"></span>
                <span class="divider-icon">❀</span>
                <span class="divider-line"></span>
            </div>

            <div class="section-title">— 新增食譜 —</div>

            <div class="form-group">
                <label>菜名 (中文)</label>
                <input type="text" id="recipeName" placeholder="例：青醬義大利麵">
            </div>

            <div class="form-group">
                <label>English Name</label>
                <input type="text" id="recipeEnglish" placeholder="e.g. Pesto Pasta">
            </div>

            <div class="form-group">
                <label>食材 (用逗號分隔)</label>
                <input type="text" id="recipeIngredients" placeholder="例：義大利麵, 青醬, 起司">
            </div>

            <button class="btn" onclick="addRecipe()">新增食譜 ➕</button>

            <div class="divider">
                <span class="divider-line"></span>
                <span class="divider-icon">❀</span>
                <span class="divider-line"></span>
            </div>

            <div class="section-title">— 現有食譜 —</div>

            <div id="recipesList">
                <p class="no-messages">載入中...</p>
            </div>

            <button class="btn btn-secondary" onclick="signOut()">
                登出
            </button>

            <footer>
                <p class="footer-text">用滿滿的愛為你準備 <span class="footer-dino">🦖</span></p>
            </footer>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="modal">
        <div class="modal">
            <div class="modal-icon">🦕</div>
            <h2>訂單已送出！</h2>
            <div class="order-summary" id="orderSummary"></div>
            <p>小恐龍馬上為你準備～請稍等一下哦</p>
            <button class="modal-btn" id="closeModal">好的，謝謝 🦖</button>
        </div>
    </div>

    <!-- Floating hearts container -->
    <div class="dinos-container" id="dinosContainer"></div>

    <!-- App Script -->
    <script type="module" src="/src/main.js"></script>
</body>
</html>
